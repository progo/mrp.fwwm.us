<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />


        <!-- standard -->
	<title>Mr. P: Mikrobloggailua talossa</title>


	<link rel="home" href="../../index.html" />

	<link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="../../atom/index.html?section=mietteet" />
	<link rel="alternate" type="application/rss+xml" title="RSS 0.92" href="../../rss/index.html?section=mietteet" />

	<link rel="stylesheet" type="text/css" media="screen" href="../../blog.css" />
        <link rel="stylesheet" type="text/css" href="../../codeblock.css" />

            <!-- SyntaxHighlighter: http://alexgorbatchev.com -->
    <script type="text/javascript" src="../../scripts/xregexp-min.js"></script>
    <script type="text/javascript" src="../../scripts/shCore.js"></script>
    <!-- langs -->
    <script type="text/javascript" src="../../scripts/shBrushBash.js"></script>
    <script type="text/javascript" src="../../scripts/shBrushCpp.js"></script>
    <script type="text/javascript" src="../../scripts/shBrushPhp.js"></script>
    <script type="text/javascript" src="../../scripts/shBrushPerl.js"></script>
    <script type="text/javascript" src="../../scripts/shBrushPython.js"></script>
    <script type="text/javascript" src="../../scripts/shBrushClojure.js"></script>
    <script type="text/javascript" src="../../scripts/shBrushJava.js"></script>
    <script type="text/javascript" src="../../scripts/shBrushHaskell.js"></script>
    <script type="text/javascript" src="../../scripts/shBrushVimscript.js"></script>
    <script type="text/javascript">
        SyntaxHighlighter.all();
    </script>

	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../rpc/index.html" />
</head>

<body id="mietteet">

<!-- accessibility -->
<div id="accessibility">
    <ul>
        <li><a href="mikrobloggailua-talossa#content">Siirry sisältöön</a></li>
        <li><a href="mikrobloggailua-talossa#sidebar-2">Siirry hakuun</a></li>
    </ul>
</div>

<div id="container">

<!-- head -->
    <div id="head">
        <h1 id="site-name"><a rel="home" href="../../index.html">Mr. P</a></h1>
        <p id="site-slogan">Asiaa porjoilun tuolta puolen</p>
    </div>

<!-- right -->
    <div id="sidebar-2">
        <ul class="section_list">
	<li>
            
            <a href="../../hetket/index.html">Hetkessä</a>
            
        </li>
	<li>
            
            <a href="../../matematiikka/index.html">Matematiikka</a>
            
        </li>
	<li>
            &raquo;
            <a href="../index.html">Mietteet</a>
            
                <!--<ul>
	<li>
                    
                    <a rel="bookmark" href="/mietteet/598/blogille-idea">Blogille&#160;idea</a>
                </li>
	<li>
                    
                    <a rel="bookmark" href="/mietteet/597/wes-mckinney-python-for-data-analysis-oreilly">Wes McKinney - Python For Data Analysis (O&#39;Reilly)</a>
                </li>
	<li>
                    
                    <a rel="bookmark" href="/mietteet/596/org-blogaaminen-vaikeata">Org-blogaaminen&#160;vaikeata</a>
                </li>
	<li>
                    
                    <a rel="bookmark" href="/mietteet/595/twitterointia-emacsilla">Twitteröintiä&#160;Emacsilla</a>
                </li>
	<li>
                    
                    <a rel="bookmark" href="/mietteet/594/weboodi-aikataulut-orgiin">WebOodi-aikataulut&#160;orgiin</a>
                </li>
	<li>
                    
                    <a rel="bookmark" href="/mietteet/593/emacsin-salat-alkavat-selvita-org-kovenee-ja-muita-tarinoita">Emacsin salat alkavat selvitä; org kovenee ja muita&#160;tarinoita</a>
                </li>
	<li>
                    
                    <a rel="bookmark" href="/mietteet/592/emacs-has-me">Emacs has&#160;me.</a>
                </li>
	<li>
                    
                    <a rel="bookmark" href="/mietteet/591/editorien-taistelu-tietamyshallinnassa">Editorien taistelu&#160;tietämyshallinnassa</a>
                </li>
	<li>
                    
                    <a rel="bookmark" href="/mietteet/590/think-vimorganizer">Think&#160;VimOrganizer.</a>
                </li>
	<li>
                    
                    <a rel="bookmark" href="/mietteet/589/think-orgmode">Think&#160;orgmode.</a>
                </li>
</ul>-->
            
        </li>
</ul>
<!--        <p class="sidebarhead">Aiheita:</p>
        <ul class="category_list">
	<li><a href="/kategoria/hifi/">Hifi</a></li>
	<li><a href="/kategoria/koodaus/">Ohjelmointi</a></li>
	<li><a href="/kategoria/ohjelmistot/">Ohjelmistot</a></li>
	<li><a href="/kategoria/Opiskelu/">Opiskelu</a></li>
	<li><a href="/kategoria/rauta/">Rauta</a></li>
	<li><a href="/kategoria/viihde/">Viihde</a></li>
	<li><a href="/kategoria/Yleistae-turinaa/">Yleistä turinaa</a></li>
</ul> -->

        <p class="sidebarhead">Valikoituja aiheita:</p>
        <ul class="category_list">
	<li><a href="../../tag/bash/index.html" class="tagSizeSmallest tagSize1" style="font-size: 100%;">bash</a></li>
	<li><a href="../../tag/gentoo/index.html" class="tagSizeLargest tagSize107" style="font-size: 100%;">gentoo</a></li>
	<li><a href="../../tag/hifi/index.html" class="tagSizeMedium tagSize33" style="font-size: 100%;">hifi</a></li>
	<li><a href="../../tag/musiikki/index.html" class="tagSizeMedium tagSize25" style="font-size: 100%;">musiikki</a></li>
	<li><a href="../../tag/ohjelmointi/index.html" class="tagSizeMedium tagSize44" style="font-size: 100%;">ohjelmointi</a></li>
	<li><a href="../../tag/ostoksia/index.html" class="tagSizeMedium tagSize13" style="font-size: 100%;">ostoksia</a></li>
	<li><a href="../../tag/rauta/index.html" class="tagSizeMedium tagSize25" style="font-size: 100%;">rauta</a></li>
	<li><a href="../../tag/vim/index.html" class="tagSizeMedium tagSize36" style="font-size: 100%;">vim</a></li>
</ul>
        <p><a href="../../tag/index.html">Kaikki tagit</a></p>

        <form method="get" action="../../index.html">
<p class="search_input">Hae<br /><input type="text" value="" name="q" size="15" /></p>
</form>

        <p><a href="../../rss/index.html?section=mietteet" title="RSS 0.92">RSS</a> / <a href="../../atom/index.html?section=mietteet" title="Atom 1.0">Atom</a></p>
        <p class="linklist"><a href="http://textpattern.net/">TextBook</a><br /><a href="http://textpattern.com/">Textpattern</a><br /><a href="http://textpattern.org/">Txp Resources</a><br /><a href="http://twitter.com/progo_" title="Twitter-profiilini">Twitter</a><br /></p>

        <p><a href="http://textpattern.com/"><img src="../../images/2.png" alt="Textpattern CMS" width="105" height="45" /></a></p>
    </div>


<!-- center -->
    <div id="content">



<!-- not tag view, it's the main view -->


        

        <div class="hfeed">
            <!-- five articles to list here, or only one. It depends. -->
            <!-- default form -->

<p class="published">21. tammikuu 2011, 18:11</p>
<h1 class="entry-title"><a rel="bookmark" href="mikrobloggailua-talossa">Mikrobloggailua&#160;talossa</a></h1>


<div class="entry-content">
	<p>Ja nyt sitä mikrobloggailua on tässä. <a href="../368/mikrobloggailua-luvassa">Edellinen artikkeli</a> johti mielettömän kovaan arpomiseen ja pohdintaan, onko se oikeasti sen arvoista kirjoittaa mikroblogia itselleen, sen sijaan että &#8212; Twitterissä on oikeasti hienoja puolia.</p>

	<p>Kirjailin Python-skriptin Twitterin henkeen. Samainen skripti taipuu helposti myös tavallisten, pidempien blogikirjoitusten kasvualustaksi. Kyseessä on siis ihannoimani komentoriviklientti. Mikäli Twitteriin joskus sitten uskaltaudun, voin olla kuin kotonani. Ehkäpä näytän sen, sillä se ei ole kauhean pitkä. Jaoin sen kolmeen osaseen. Ensimmäinen osa koskee varsinaista viestinvälitystä internettiin:</p>

<pre class="python"># coding=utf8
import xmlrpclib
srvr = xmlrpclib.Server(&quot;/rpc/&quot;)

username = &quot;progo&quot;
password = &quot;&quot;
section = &quot;hetket&quot;
to_publish = True

# Hae tarvittavat datat ja lähetä uusi miete maailmalle
def send_shout(description, keyword_string):
  # hae viimeisin id:
  try:
    newest = srvr.metaWeblog.getRecentPosts(section, username, password, 1)[0][&#39;postid&#39;]
  except IndexError:
    newest = 0

  # kirjoitellaan viestin runko valmiiksi
  post = {&#39;title&#39;: &#39;hetkessä nro &#39; + str(int(newest) + 1),
          &#39;description&#39;: description,
          &#39;mt_keywords&#39;: keyword_string}

  srvr.metaWeblog.newPost(section, username, password, post, to_publish)
</pre>

	<p>Heh, ei vikasietoisuutta vielä tässä vaiheessa. Otsikot nimeän kaavan mukaan about yksiselitteisesti, jotta ne on helppo hakea kannasta. Metodi <code>send_shout</code> ottaa sisäänsä siis vain kaksi merkkijonoa, joista toinen menee tsirpityksen sisällöksi ja toinen on pilkuin eroteltu lista tageja.</p>

	<p>Ja mitenkö otan tagit vastaan komentoriviltä? Hyödynnän Twitterin merkintätapoja ja käytän risuaitamerkintojä. Esimerkiksi viestin loppuun heitetty <code>#python</code> liittäisi asiaankuuluvan tagin viestini perälle. Se poistettaisiin varsinaisesta viestistä. Jotta yllätyksiltä vältyttäisiin, haen vain lopusta alkaen, ja lopetan heti kun ensimmäinen muulla merkillä alkava sana tavataan. Koodi on kamalan imperatiivista, mutta alkuperäinen <em>list comphrehensioineita</em> käyttänyt versio olisi mennyt liian vaikeaksi.</p>

<pre class="python"> # coding: utf-8
# handle information. In this case, tags
def extract_tags(description):
  if type(description) == type(&#39;str&#39;):
    description = description.split(&quot; &quot;)
  tags = []
  index = len(description) - 1
  while index &gt; 0:
    if description[index].startswith(&quot;#&quot;):
      tags.append(description[index][1:])
      del description[index]
      index -= 1
      continue
    elif len(description[index].strip()) == 0:
      continue
    else:
      break
  return (&quot; &quot;.join(description), &quot;, &quot;.join(tags))
</pre>

	<p>Tästä sanoisin sen sanasen, että Pythonin merkkijonoille löytyvä metodi <code>.split</code> on näppärä apuväline myös ilman argumenttiansa, jolloin se vastaa säännöllistä lauseketta <code>/ +/</code> (tai <code>/\s+/</code>, jos <code>\s</code> tarkoittaa tyhjien merkkien joukkoa). Mutta jos haenkin erityisesti aina yhden välin mittaisia erottimia, saan tuloksena syntyvään taulukkoon tyhjiä merkkijonoja. Ei tietysti kivaa, mutta nyt lopussa tehtävä palasten yhteenliimailu tuottaa alkuperäistä vastaavan merkkijonon!  Aika kiva jäynä, ettenkö sanoisi. Minun pitää vain lisätä while-silmukan sekaan yksi ylimääräinen <code>elif</code>. </p>

	<p>Siinä olivat työkalut, ja nyt itse komentoriviohjelma:</p>

<pre class="python"> #!/usr/bin/python
# This shamelessly named CLI front-end will take all the thoughts and send them
# to the blog

import sys, tempfile
from subprocess import call
import post_handler, post_sender

if len(sys.argv) == 1: # use the Editor. Probably happens rarely
  tempfile = tempfile.NamedTemporaryFile()
  call([&quot;vim&quot;, tempfile.name])
  message = &quot;\n&quot;.join(tempfile.readlines())
  tempfile.close()
else:
  # the argv is ours...
  message = sys.argv[1:]

(msg, tags) = post_handler.extract_tags(message)
post_sender.send_shout(msg, tags)
</pre>

	<p>Nimesin sen todella <code>tweet.py</code>:ksi, kun en muutakaan keksinyt. Voin käyttää vimiäkin viestin kirjoittamiseen, jos haluan. Hakemalla ympäristömuuttujat esille voisin tehdä koodista käyttäjäystävällisempää, mutta nyt laiskuuttani en tehnyt sitä.  Kaikin puolin Python on hyvin tyydyttävä kieli komentorivisovelluksiin. Olisin kirjoittanut Clojurella, mutta <span class="caps">JVM</span>:n käynnistysaikoja en halua katsella aina kun haluan sanoa jotain ääneen. Ehkä pitäisi opiskella Schemen alkeet niin saisin natiivikoodista lispiä.</p>

	<p>Mutta nyt on myös blogin puolella useimmat ongelmista ratkottu. Erottelin lyhyet huudahdukset hyvin pois oikeista kirjoitelmista, ja ajattelin onnistuneeni siinä yllättävän hyvin. Mutta vain aika näyttää, miten tässä käy. Twitter siellä tsirpittelee, kutsuu. Odottaa, jos teen virheen.</p>
</div>

<p class="tags"> 


Tageja: <a href="../../tag/blogisäätöä/index.html" rel="tag">blogisäätöä</a>, 
<a href="../../tag/python/index.html" rel="tag">python</a>, 
<a href="../../tag/twitter/index.html" rel="tag">twitter</a>


</p>



<div class="divider"><img src="../../images/1.gif" alt="---" width="400" height="1" /></div>


        </div>

 <!-- now, common stuff -->

        <div class="divider"><img src="../../images/1.gif" alt="---" width="400" height="1" /></div>

        <p><a rel="prev" href="../368/mikrobloggailua-luvassa" title="Mikrobloggailua luvassa">&#171; Mikrobloggailua luvassa</a> 
           &mdash; <a rel="next" href="../416/blogia-nyt-komentorivilta" title="Blogia nyt komentoriviltä">Blogia nyt komentoriviltä &#187;</a>
        </p>

        <div class="divider"><img src="../../images/1.gif" alt="---" width="400" height="1" /></div>
        <h2>Aiheen vierestä</h2>
        <ul class="directory">

<li><span class="entry-title"><a rel="bookmark" href="../598/blogille-idea">Blogille&#160;idea</a></span> &#183; <span class="published">2013-01-05</span>
<br /><span class="smallexcerpt">Uuden org-pohjaisen blogialustan miettiminen ja kehittäminen on vasta aluillaan, vaikka yhä uskon joustavamman alustan tarjoavan paremman kanavan tajunnanvirtani ohjaamiselle. Ja...</span>
</li>



<li><span class="entry-title"><a rel="bookmark" href="../597/wes-mckinney-python-for-data-analysis-oreilly">Wes McKinney - Python For Data Analysis (O&#39;Reilly)</a></span> &#183; <span class="published">2012-11-30</span>
<br /><span class="smallexcerpt">O&#8217;Reillyn hienon blogiohjelman kautta ilmaiseksi saamani kirja kertoo tyydyttävästi kaikenlaista, mitä Matlabia ja R:ää kammoksuva haluaa tietää! Tässä tapailen mietteitä...</span>
</li>



<li><span class="entry-title"><a rel="bookmark" href="../594/weboodi-aikataulut-orgiin">WebOodi-aikataulut&#160;orgiin</a></span> &#183; <span class="published">2012-10-23</span>
<br /><span class="smallexcerpt">Itä-Suomen yliopiston weboodissa alkaa olla aika usein kurssi-infot hyvässä kunnossa, ja nyt on myös joensuulaisille olemassa tuota lukkaria, joka on...</span>
</li>



<li><span class="entry-title"><a rel="bookmark" href="../586/puolitoista-vuotta-twitterissa">Puolitoista vuotta&#160;Twitterissä</a></span> &#183; <span class="published">2012-08-14</span>
<br /><span class="smallexcerpt">Tänään kävelyllä tulin pohtineeksi hieman Twitterissä vietettyjä minuutteja. Suureksi sosiaaliseksi mediaksi Twitter on edelleen se paras kaikista, koska se ei...</span>
</li>



<li><span class="entry-title"><a rel="bookmark" href="../584/pythonin-vastaisku-lispeille-ipython-ja-vim-ipython">Pythonin vastaisku lispeille: IPython ja vim-ipython</a></span> &#183; <span class="published">2012-07-25</span>
<br /><span class="smallexcerpt">Tai &#8220;Pythonin uusi toivo&#8221; tai &#8220;Pythonin paluu&#8221;. Mistä on kyse? Pythonin tulkin me kaikki kai tiedämme: kaikki siinä periaatteessa on,...</span>
</li>



<li><span class="entry-title"><a rel="bookmark" href="../581/sumitup-puutteet-ja-mihin-suuntaan-edetaan">SumItUp: puutteet ja mihin suuntaan&#160;edetään</a></span> &#183; <span class="published">2012-07-12</span>
<br /><span class="smallexcerpt">Esittelin pari postausta sitten Soulver-kloonin raakileen, SumItUpin. Nyt se on GitHubissa kaikkien pällisteltävänä ja sellaisella raakileasteella, jotta sitä voi jo...</span>
</li>



<li><span class="entry-title"><a rel="bookmark" href="../579/soulver-kloonia-rakentelemassa">Soulver-kloonia&#160;rakentelemassa</a></span> &#183; <span class="published">2012-07-07</span>
<br /><span class="smallexcerpt">Erittäin upealla konseptilla varustettu laskinohjelma Soulver kaatuu siihen, että sen saa vain Mäkille. Vapaamuotoinen näpertelyalusta on usein ainut asia, mitä...</span>
</li>



<li><span class="entry-title"><a rel="bookmark" href="../556/korintaytto-ja-ahne-menetelma">Korintäyttö ja ahne&#160;menetelmä</a></span> &#183; <span class="published">2011-10-23</span>
<br /><span class="smallexcerpt">Mietiskelen tässä korintäyttöä (bin packing) ja sitä, miten ahne menetelmä on joko ylipolynomiaalinen tai sitten epäoptimaalinen.  Luultavasti se on...</span>
</li>



<li><span class="entry-title"><a rel="bookmark" href="../524/blogin-varityksesta">Blogin&#160;värityksestä</a></span> &#183; <span class="published">2011-04-18</span>
<br /><span class="smallexcerpt">Säädin blogin värejä. Rukoilkaa, etten säädä niitä enempää.

	Tajusin, että ihmiset eivät välttämättä vastusta valkoista-mustalla -väriteemaa suinkaan tummasta taustasta johtuen, vaan...</span>
</li>



<li><span class="entry-title"><a rel="bookmark" href="../520/ihmekuusessa-400-levya">Ihmekuusessa 400&#160;levyä</a></span> &#183; <span class="published">2011-03-25</span>
<br /><span class="smallexcerpt">Nyt Audioslaven arvioituani Ihmekuusessa/Havuviuhkalla on selattavissa 400 levyn mietteet. Melko pyöreitä lukuja tuli tahattomasti myös statseihin. Sanoja on yhteensä näissä...</span>
</li>

</ul>

    </div>


<!-- footer -->
	<div id="foot">&nbsp;</div>

</div>

</body>
</html>
